language: node_js
node_js:
- '8'
env:
  global:
  #- USER="IgnacioPasamontes"
  #- EMAIL="ignacio.pasamontes@upf.edu"
  - ORG="phi-grib"
  - REPO="DjangoAPI"
  #- FILES="./dist/frontend/*"
  - GH_REPO="github.com/${ORG}/${REPO}.git"
  - secure: "QBFkf9BP3xqCF06iR/U6wsvacc3+qr9BH6sKmxlg9jbo5fjO7f8TDYSFdT63ICJfUq+RaCcPYOyveT2LJRV4EDSgaRiolluUTHOblZ6AWmN1i+XCnKn0ZN9hTRttsUZAezyIq+RtwbzRk6p22P7e3/pBpUnACxRQ5LUlcD6ZcQJPZXRhOTK1AYCSuE30N5erd1kzW3eKy5SABXYG8fQE8hBqzjxgTj6xkJ8RM7vWaXi7k0JyKmq+XJ8KBk7EE40BTD6vG8GQgZQQnqQahxK5Hb35CML46glKuPuG1bNZxH920TOXSJ6D6P0n7s4YYT9ghBoyhrfK1yT1obatNLSGwP1B9WD/NXMqTMIo+fNqXmOhnI6joRJkxVBVVbUu/rBTp2xR4LhCJ6S/68LiIiFqBcAkEbvQen3CMeA+4WharN6LQItnvzLJ6JNEOWTK2T2zhiAzUpugZzj9iz3HSqHjTFRKsZcHUCLkki1/EeNSLzZ+5vHjjSjwHfstY1d5hfBGukjWChEJTGh7dvWUMky0NU1zM1F3SDP+434kE3xdDQYAlQE3cnL4TY/55zr+s5PZCEpz7YbrggI0DFSEoOurWIfXofaGhJXz6SjlM6Qggf6NsYsSDt8omAFS/7Q5QnbVNLCLWLzVGPAbKDZaWO9KDC3h8jDU1Pda+4dQXQU7dog="

 
efore_script:
- npm install -g @angular/cli
script:
- ng build --prod --aot  --output-hashing none
after_success:
- MESSAGE=$(git log --format=%B -n 1 $TRAVIS_COMMIT)
- git clone https://github.com/phi-grib/DjangoAPI.git
- pwd
- ls -l
- rm -rfv ./DjangoAPI/static/*
- cd DjangoAPI/
- git remote
- git config user.email ignacio.pasamontes@upf.edu
- git config user.name "IgnacioPasamontes"
- git rm static/*
- git commit -m 'BUILD:Remove statics'
- git push "https://Travis@${GH_REPO}"


#ADD static
- mkdir static
- mv -f ../dist/frontend/* ./static
- git remote
- git config user.email ignacio.pasamontes@upf.edu
- git config user.name "IgnacioPasamontes"
- git add static/*
- git commit -m 'BUILD:ADD statics'
- git push "https://Travis@${GH_REPO}"