language: node_js
node_js:
- '8'
env:
  global:
  - USER="IgnacioPasamontes"
  - EMAIL="ignacio.pasamontes@upf.edu"
  - ORG = "phi-grib"
  - REPO="DjangoAPI"
  - FILES="./dist/frontend/*"
  - GH_REPO="github.com/${ORG}/${REPO}.git"
  #- secure: ""
 
before_script:
- npm install -g @angular/cli
script:
- ng build --prod --aot  --output-hashing none
after_success:
- MESSAGE=$(git log --format=%B -n 1 $TRAVIS_COMMIT)
- echo ${MESSAGE}
- git clone https:/github.com/phi-grib/DjangoAPI.git
- pwd
- ls -l
- rm -rfv ./DjangoAPI/static/*
- cd DjangoAPI/
- git rm static/*
- git remote
- git config user.email ${EMAIL}
- git config user.name ${USER}
- git commit -m 'BUILD:Remove statics'
- git push "https://${SOMEVAR}@${GH_REPO}" master > /dev/null 2>&1Travis token name
